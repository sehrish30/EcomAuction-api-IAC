
type LoggerType = {
  type: string;
  payload: string;
  message?: string;
  callstack?: any
}

// lambda layer uncompressed size must be less than 250MB
const handler = async ({type, payload, message, callstack}: LoggerType) => {
  const error = {
    type: type || "CRITICAL",
    message: message || "Too many connections",
    payload,
    callstack
  };
  // all logs go to cloudwatch
  // lets stream those logs in kinesis firehouse
  // https://www.serverless.com/plugins/serverless-plugin-log-subscription
  console.log(JSON.stringify(error));

  return {
    statusCode: 200,
    body: JSON.stringify(error),
  };
};
export default handler;