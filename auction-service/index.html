<html>
  <body>
    <button onclick="upload()">Upload Large Payload</button>
    <script>
      const apiEndpoint =
        "https://hq84otoqva.execute-api.us-east-2.amazonaws.com/dev/s3url";
      const todosEndpoint = "http://jsonplaceholder.typicode.com/todos";

      upload = async () => {
        const todos = await getTodos();
        const data = await getSignedUrl();
        const result = await uploadToS3(data.url, todos);
        console.log("Successfully Uploaded to S3");
      };

      const headers = new Headers();
      headers.append("Content-Type", "application/json");
      headers.append(
        "Authorization",
        "Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImRuVllPYkU5SV9zOHRHZ21pd3Z1YiJ9.eyJuaWNrbmFtZSI6InNlaHJpc2h3YWhlZWQ5OCIsIm5hbWUiOiJzZWhyaXNod2FoZWVkOThAZ21haWwuY29tIiwicGljdHVyZSI6Imh0dHBzOi8vcy5ncmF2YXRhci5jb20vYXZhdGFyL2YyZWM0M2Q0NGI3OTUyMGZiODgwZjBiMDBiMWY2MmI5P3M9NDgwJnI9cGcmZD1odHRwcyUzQSUyRiUyRmNkbi5hdXRoMC5jb20lMkZhdmF0YXJzJTJGc2UucG5nIiwidXBkYXRlZF9hdCI6IjIwMjMtMDUtMTJUMTg6MDk6MTUuOTM4WiIsImVtYWlsIjoic2VocmlzaHdhaGVlZDk4QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL2Rldi1tdHpyZm1jcjI0NnN2am42LnVzLmF1dGgwLmNvbS8iLCJhdWQiOiJreTRDNlhYelhRaFhITm5uUGg5aURKcW82UVc1OXpQViIsImlhdCI6MTY4MzkxNDk1NSwiZXhwIjoxNjgzOTUwOTU1LCJzdWIiOiJhdXRoMHw2NDFlMTFjZmY5MzkzNjVhNTY4ZjBmYWYifQ.N2KEEdMDGMSzu9Khzko5eUY3h4Hyz76Qr0X6z8kXmh_3IZvUyl0Wp0I0E29KK5AvMHqntMNRcpH89R2KL1t0_WHIHdgTKvjsVvf5sYeonYUyakzPGYxY8AgAqKS-xadl8f3QXL0b8g3x_6jtwsIaFw4vD-ZiorZkET2aMeb5d3ljBiSObaIv1idD_0aqITAs_-JICl71sld7WEs0kye_CWaD7KOUaKbiF77O4rZevHclnpNI9eUbIlT0Twp_QoWsx9fUeav7lYA5qDHWXQKGz4cc3qQTIlqIdmbgwg6DvrzuEHKi6pxWcjfUM9bTmUeNjRJZgIQaJ5BzcioaMcoF0g"
      );
      getTodos = async () => {
        return fetch(todosEndpoint)
          .then((res) => res.json())
          .then((data) => data);
      };

      getSignedUrl = async () => {
        return fetch(apiEndpoint, {
          headers: headers,
        })
          .then((res) => res.json())
          .then((data) => data);
      };

      uploadToS3 = async (url, todos) => {
        return fetch(url, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ todos }),
        })
          .then((res) => res.text())
          .then((data) => data);
      };
    </script>
  </body>
</html>
